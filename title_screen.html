<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MegaFuture — Depth Carousel</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">

<style>
:root{
  --mega-pink: #E60C9A;
}

html { background:#b3231f; }

body{
  margin:0;
  height:100%;
  background:#000;
  display:grid;
  place-items:center;
  overflow:hidden;
}

#mfModal{
  position: fixed;
  inset: 0;
  z-index: 99999;
  display: grid;
  place-items: center;
  background: #000;
  overflow: hidden;
  user-select: none;
}

.stage {
  width: min(92vw, 900px);
  aspect-ratio: 16 / 9;
  display:grid;
  place-items:center;
  perspective: 1200px;
  position: relative;
}

.space {
  position: relative;
  width: min(90vw, 760px);
  aspect-ratio: 16 / 9;
  transform-style: preserve-3d;
}

.logoWrap{
  position: relative;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
}

.stack {
  position:absolute;
  inset:0;
  transform-style: preserve-3d;
}

.layer {
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:contain;

  animation-name: microDrift;
  animation-timing-function: ease-in-out;
  animation-iteration-count: infinite;
  will-change: transform;
}

/* lock logo_1 only */
.layer.noDrift{
  animation: none !important;
  transform: none !important;
  will-change: auto;
}

@keyframes microDrift{
  0%   { transform: translate3d(0px,0px,0); }
  50%  { transform: translate3d(var(--dx, 0px), var(--dy, 0px), 0); }
  100% { transform: translate3d(0px,0px,0); }
}

.carousel {
  position:absolute;
  left:50%;
  top:50%;
  transform-style: preserve-3d;
}
.carousel.ring1 { top: 44%; }
.carousel.ring2 { top: 56%; }

.item{
  position:absolute;
  left:50%;
  top:50%;
  transform-style: preserve-3d;

  font-family:
    "Eurostile",
    "Microgramma",
    "Orbitron",
    "Bank Gothic",
    system-ui,
    sans-serif;

  font-weight: 700;
  font-size: 18px;
  letter-spacing: 0.06em;

  user-select:none;
  pointer-events:none;
  white-space:pre;

  display:inline-block;
  position:absolute;
}

.ring1 .item{
  color: var(--mega-pink);
  -webkit-text-stroke: 0;
  text-stroke: 0;

  text-shadow:
    0 0 2px  rgba(230,12,154,.95),
    0 0 6px  rgba(230,12,154,.75),
    0 0 12px rgba(230,12,154,.55),
    0 0 24px rgba(230,12,154,.35),
    0 0 48px rgba(230,12,154,.18);
}

.ring1 .item::before{
  content: attr(data-ch);
  position:absolute;
  inset:0;
  transform: scale(0.88);
  transform-origin: center;
  color: rgba(0,0,0,.92);
  filter: blur(0.2px);
  text-shadow: none;
  pointer-events:none;
}

.ring1 .item::after{
  content: attr(data-ch);
  position:absolute;
  inset:0;
  transform: scale(0.93);
  transform-origin: center;
  color: rgba(0,0,0,.55);
  filter: blur(0.6px);
  text-shadow: none;
  pointer-events:none;
}

.ring2 .item{
  color: #ffffff;
  -webkit-text-stroke: 0;
  text-stroke: 0;

  text-shadow:
    0 0 2px  rgba(255,255,255,.95),
    0 0 6px  rgba(255,255,255,.75),
    0 0 12px rgba(255,255,255,.55),
    0 0 24px rgba(255,255,255,.35),
    0 0 48px rgba(255,255,255,.18);
}

#loader{
  position: absolute;
  left: 50%;
  top: calc(80%);
  transform: translateX(-50%);
  font-family: "Orbitron", system-ui, sans-serif;
  font-weight: 500;
  font-size: 13px;
  letter-spacing: 0.18em;
  color: rgba(255,255,255,.9);
  user-select: none;
  pointer-events: none;
  text-shadow:
    0 0 6px rgba(255,255,255,.18),
    0 0 18px rgba(255,255,255,.10);
}

#fictionBlurb{
  position: absolute;
  left: 50%;
  bottom: 3vh;
  transform: translateX(-50%);
  max-width: min(90vw, 720px);

  font-family: system-ui, sans-serif;
  font-size: 11px;
  line-height: 1.45;
  text-align: center;
  color: rgba(255,255,255,.45);

  user-select: none;
  pointer-events: none;
}
</style>
</head>

<body>

<div id="mfModal" aria-hidden="true">
  <div class="stage">
    <div class="space">
      <div class="logoWrap">
        <div class="stack">
          <img class="layer" src="images/megafuture_logo_4.PNG" alt="">
          <img class="layer" src="images/megafuture_logo_3.PNG" alt="">
          <img class="layer" src="images/megafuture_logo_2.PNG" alt="">
          <img class="layer noDrift" src="images/megafuture_logo_1.PNG" alt="">
        </div>

        <div class="carousel ring1" id="ringMega"></div>
        <div class="carousel ring2" id="ring232"></div>

        <div id="loader">loading.</div>
      </div>
    </div>
  </div>

  <div id="fictionBlurb">
    <div>This work is a work of fiction.</div>
    <div>All characters and events portrayed in this game are fictional.</div>
    <div>Any resemblance to real persons, living or dead, or actual events is purely coincidental.</div>
  </div>
</div>

<script>
/* ===== MICRO PARALLAX (4x faster)
   IMPORTANT: do NOT apply to .noDrift (logo_1)
*/
(function initMicroParallax(){
  const layers = document.querySelectorAll(".stack .layer:not(.noDrift)");
  layers.forEach((img) => {
    const dx = ((Math.random() * 3.2) - 1.6).toFixed(2); // +/-1.6px
    const dy = ((Math.random() * 3.2) - 1.6).toFixed(2);

    const dur = (1.5 + Math.random() * 1.0).toFixed(2);  // 1.5–2.5s
    const delay = (-(Math.random() * parseFloat(dur))).toFixed(2);

    img.style.setProperty("--dx", dx + "px");
    img.style.setProperty("--dy", dy + "px");
    img.style.animationDuration = dur + "s";
    img.style.animationDelay = delay + "s";
  });
})();

function buildGlyphRing(el, text, radius, opts={}){
  const { letterSpacingPx = 6, fontSizePx = 18 } = opts;
  el.innerHTML = "";

  const glyphs = [];
  for (const ch of text){
    const d = document.createElement("div");
    d.className = "item";
    d.style.fontSize = fontSizePx + "px";
    d.textContent = ch;
    d.setAttribute("data-ch", ch);
    el.appendChild(d);
    glyphs.push(d);
  }

  const widths = glyphs.map(g => g.getBoundingClientRect().width);
  const totalPx = widths.reduce((a,b)=>a+b,0) + letterSpacingPx*(glyphs.length-1);

  let s = -totalPx/2;
  for (let i=0;i<glyphs.length;i++){
    const w = widths[i];
    const centerS = s + w/2;
    glyphs[i].dataset.theta0 = centerS / radius;
    s += w + letterSpacingPx;
  }

  el.radius = radius;
}

function updateGlyphRing(el, angleDeg){
  const r = el.radius;
  const aRad = angleDeg * Math.PI / 180;

  el.querySelectorAll(".item").forEach(g=>{
    const theta0 = parseFloat(g.dataset.theta0) || 0;
    const theta = theta0 + aRad;

    const z = Math.cos(theta) * r;
    const x = Math.sin(theta) * r;

    const scale = (z + r) / (r * 2) + 0.5;
    const opacity = Math.max(0.35, scale);

    g.style.transform =
      `translate(-50%, -50%)
       translateX(${x}px)
       translateZ(${z}px)
       rotateY(${-theta * 180/Math.PI}deg)
       scale(${scale})`;

    g.style.opacity = opacity;
  });
}

/* motion (UNCHANGED: your stable base) */
const FPS = 60;
const moveFrames = 110;
const pauseFrames = Math.round(2 * FPS);
const cycleFrames = moveFrames + pauseFrames;

function angleForFrame(f){
  const m = f % cycleFrames;
  return m < moveFrames ? (m / moveFrames) * 360 : 360;
}

const ringMega = document.getElementById("ringMega");
const ring232  = document.getElementById("ring232");

buildGlyphRing(ringMega, "MEGAFUTURE", 125, { letterSpacingPx: 9, fontSizePx: 18 });
buildGlyphRing(ring232,  "232",        110, { letterSpacingPx: 10, fontSizePx: 18 });

/* ===== start at perigee, wait 2s, then animate (UNCHANGED) ===== */
const START_DELAY_MS = 2000;
const startTime = performance.now();
let frame = 0;
let rafId = 0;

function tick(){
  const elapsed = performance.now() - startTime;

  if (elapsed < START_DELAY_MS){
    updateGlyphRing(ringMega, 0);
    updateGlyphRing(ring232,  0);
    rafId = requestAnimationFrame(tick);
    return;
  }

  frame++;
  const a = angleForFrame(frame);
  updateGlyphRing(ringMega, -a);
  updateGlyphRing(ring232,  +a);
  rafId = requestAnimationFrame(tick);
}
tick();

/* ===== LOADING CYCLER (forever until closed) ===== */
const loaderInterval = (() => {
  const el = document.getElementById("loader");
  if (!el) return null;

  let dots = 1;
  return setInterval(() => {
    dots = (dots % 3) + 1;
    el.textContent = "loading" + ".".repeat(dots);
  }, 420);
})();

/* ===== RIGHT MOUSE CLOSES + REMOVE FROM DOM ===== */
const modal = document.getElementById('mfModal');

function closeModal(){
  if (rafId) cancelAnimationFrame(rafId);
  if (loaderInterval) clearInterval(loaderInterval);
  if (modal && modal.parentNode) modal.parentNode.removeChild(modal);
}

modal.addEventListener('contextmenu', (e) => {
  e.preventDefault();
  closeModal();
}, { passive: false });
</script>

</body>
</html>